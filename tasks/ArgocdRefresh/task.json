{
    "id": "b2c3d4e5-6f7a-890b-cdef-012345678901",
    "name": "ArgocdRefresh",
    "friendlyName": "ArgoCD Application Refresh",
    "description": "Refresh an ArgoCD application to detect changes from Git and optionally wait for auto-sync",
    "helpMarkDown": "This task refreshes an ArgoCD application to detect changes from the Git repository. If changes are detected and auto-sync is enabled, it can wait for the sync to complete. [More Information](https://argo-cd.readthedocs.io/en/stable/user-guide/auto_sync/)",
    "category": "Deploy",
    "author": "vburca",
    "demands": [],
    "version": {
        "Major": "1",
        "Minor": "0",
        "Patch": "0"
    },
    "minimumAgentVersion": "2.144.0",
    "instanceNameFormat": "ArgoCD Refresh: $(applicationName)",
    "groups": [
        {
            "name": "connection",
            "displayName": "Connection",
            "isExpanded": true
        },
        {
            "name": "application",
            "displayName": "Application",
            "isExpanded": true
        },
        {
            "name": "refresh",
            "displayName": "Refresh Options",
            "isExpanded": true
        },
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
            "name": "argoCDConnection",
            "type": "connectedService:argocd",
            "label": "ArgoCD Service Connection",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Select the ArgoCD service connection. Configure this in Project Settings > Service Connections.",
            "groupName": "connection"
        },
        {
            "name": "applicationName",
            "type": "pickList",
            "label": "Application Name",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "The ArgoCD application to refresh. The dropdown is populated from your ArgoCD server.",
            "groupName": "application",
            "properties": {
                "EditableOptions": "True"
            }
        },
        {
            "name": "project",
            "type": "pickList",
            "label": "Project (Optional)",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "ArgoCD project name. If specified, the application must belong to this project.",
            "groupName": "application",
            "properties": {
                "EditableOptions": "True"
            }
        },
        {
            "name": "hardRefresh",
            "type": "boolean",
            "label": "Hard Refresh",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Perform a hard refresh to force cache invalidation and fetch the latest state from Git.",
            "groupName": "refresh"
        },
        {
            "name": "waitForChanges",
            "type": "boolean",
            "label": "Wait for auto-sync if changes detected",
            "defaultValue": "true",
            "required": false,
            "helpMarkDown": "If changes are detected and the application has auto-sync enabled, wait for the sync to complete.",
            "groupName": "refresh"
        },
        {
            "name": "syncTimeout",
            "type": "string",
            "label": "Auto-sync Timeout (seconds)",
            "defaultValue": "300",
            "required": false,
            "helpMarkDown": "Maximum time to wait for auto-sync completion. Only applies if 'Wait for auto-sync' is enabled and changes are detected.",
            "groupName": "refresh",
            "visibleRule": "waitForChanges = true"
        }
    ],
    "dataSourceBindings": [
        {
            "target": "applicationName",
            "endpointId": "$(argoCDConnection)",
            "dataSourceName": "ArgoCDApplications"
        },
        {
            "target": "project",
            "endpointId": "$(argoCDConnection)",
            "dataSourceName": "ArgoCDProjects"
        }
    ],
    "execution": {
        "Node10": {
            "target": "index.js"
        },
        "Node16": {
            "target": "index.js"
        },
        "Node20": {
            "target": "index.js"
        }
    }
}